<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Examples · UnitaryTransformations.jl</title><meta name="title" content="Examples · UnitaryTransformations.jl"/><meta property="og:title" content="Examples · UnitaryTransformations.jl"/><meta property="twitter:title" content="Examples · UnitaryTransformations.jl"/><meta name="description" content="Documentation for UnitaryTransformations.jl."/><meta property="og:description" content="Documentation for UnitaryTransformations.jl."/><meta property="twitter:description" content="Documentation for UnitaryTransformations.jl."/><meta property="og:url" content="https://volkerkarle.github.io/UnitaryTransformations.jl/examples/"/><meta property="twitter:url" content="https://volkerkarle.github.io/UnitaryTransformations.jl/examples/"/><link rel="canonical" href="https://volkerkarle.github.io/UnitaryTransformations.jl/examples/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">UnitaryTransformations.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../theory/">Theory</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>Examples</a><ul class="internal"><li><a class="tocitem" href="#Jaynes-Cummings:-Dispersive-Regime"><span>Jaynes-Cummings: Dispersive Regime</span></a></li><li><a class="tocitem" href="#Two-Level-System-with-Transverse-Field"><span>Two-Level System with Transverse Field</span></a></li><li><a class="tocitem" href="#Rabi-Model:-Bloch-Siegert-Shift"><span>Rabi Model: Bloch-Siegert Shift</span></a></li><li><a class="tocitem" href="#N-Level-Atom-in-a-Cavity"><span>N-Level Atom in a Cavity</span></a></li><li><a class="tocitem" href="#Three-Level-Lambda-System"><span>Three-Level Lambda System</span></a></li><li><a class="tocitem" href="#Running-the-Examples"><span>Running the Examples</span></a></li><li><a class="tocitem" href="#Tips"><span>Tips</span></a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/volkerkarle/UnitaryTransformations.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/volkerkarle/UnitaryTransformations.jl/blob/main/docs/src/examples.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="examples"><a class="docs-heading-anchor" href="#examples">Examples</a><a id="examples-1"></a><a class="docs-heading-anchor-permalink" href="#examples" title="Permalink"></a></h1><p>This page presents complete physics examples demonstrating the Schrieffer-Wolff transformation. Each example shows the LaTeX output for easy use in publications.</p><h2 id="Jaynes-Cummings:-Dispersive-Regime"><a class="docs-heading-anchor" href="#Jaynes-Cummings:-Dispersive-Regime">Jaynes-Cummings: Dispersive Regime</a><a id="Jaynes-Cummings:-Dispersive-Regime-1"></a><a class="docs-heading-anchor-permalink" href="#Jaynes-Cummings:-Dispersive-Regime" title="Permalink"></a></h2><p>The Jaynes-Cummings model describes a two-level atom coupled to a single cavity mode:</p><p class="math-container">\[H = \omega_c a^\dagger a + \frac{\omega_q}{2}\sigma_z + g(a^\dagger\sigma^- + a\sigma^+)\]</p><p>In the <strong>dispersive regime</strong> (<span>$|\Delta| = |\omega_q - \omega_c| \gg g$</span>), the Schrieffer-Wolff transformation yields an effective Hamiltonian with a state-dependent frequency shift.</p><pre><code class="language-julia hljs">using UnitaryTransformations
using QuantumAlgebra
using Symbolics

QuantumAlgebra.use_σpm(true)

@variables Δ g  # Δ = detuning, g = coupling

# Hamiltonian (in rotating frame)
H = Δ/2 * σz() + g * (a&#39;()*σm() + a()*σp())

# Ground state subspace
P = Subspace(σz() =&gt; -1)

# Transform and display results
result = schrieffer_wolff(H, P; order=2)
show_result(result)</code></pre><p><strong>Generator:</strong></p><p class="math-container">\[S = \frac{-g}{2\Delta} a^{\dagger} \sigma^{-} + \frac{g}{2\Delta} \sigma^{+} a\]</p><p><strong>Effective Hamiltonian:</strong></p><p class="math-container">\[H_{\text{eff}} = -\frac{\Delta}{2} - \frac{g^{2}}{\Delta} a^{\dagger} a + \frac{g^{2} + \Delta^{2}}{\Delta} \sigma^{+} \sigma^{-} + \frac{2g^{2}}{\Delta} a^{\dagger} \sigma^{+} \sigma^{-} a\]</p><p><strong>Projected to subspace P</strong> (qubit ground state):</p><p class="math-container">\[H_P = -\frac{\Delta}{2} - \frac{g^{2}}{\Delta} a^{\dagger} a\]</p><h3 id="Physical-Interpretation"><a class="docs-heading-anchor" href="#Physical-Interpretation">Physical Interpretation</a><a id="Physical-Interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Interpretation" title="Permalink"></a></h3><p>The effective Hamiltonian contains:</p><ol><li><strong>Dispersive shift</strong>: <span>$\chi = -g^2/\Delta$</span> — cavity frequency shifts when qubit is in ground state</li><li><strong>AC Stark shift</strong>: Qubit frequency shifts with photon number</li></ol><p>This is the basis for <strong>qubit readout</strong> in circuit QED!</p><h3 id="Extracting-Parameters"><a class="docs-heading-anchor" href="#Extracting-Parameters">Extracting Parameters</a><a id="Extracting-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Extracting-Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">χ = extract_coefficient(result.H_P, a&#39;()*a())
println(to_latex(χ))  # Output: \frac{-g^{2}}{\Delta}

# Numerical evaluation
H_num = substitute_values(result.H_P, Dict(:g =&gt; 0.1, :Δ =&gt; 1.0))
# χ = -0.01, matching -g²/Δ</code></pre><hr/><h2 id="Two-Level-System-with-Transverse-Field"><a class="docs-heading-anchor" href="#Two-Level-System-with-Transverse-Field">Two-Level System with Transverse Field</a><a id="Two-Level-System-with-Transverse-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Level-System-with-Transverse-Field" title="Permalink"></a></h2><p>A qubit in longitudinal and transverse magnetic fields:</p><p class="math-container">\[H = \frac{\Delta}{2}\sigma_z + \varepsilon\sigma_x\]</p><p>This textbook problem has an exact solution, making it perfect for verification.</p><pre><code class="language-julia hljs">using UnitaryTransformations
using QuantumAlgebra
using Symbolics

QuantumAlgebra.use_σpm(true)

@variables Δ ε

H = Δ/2 * σz() + ε * (σp() + σm())
P = Subspace(σz() =&gt; -1)

result = schrieffer_wolff(H, P; order=2)
print_latex(result.H_P; name=&quot;H_P&quot;)</code></pre><p><strong>Output:</strong></p><p class="math-container">\[H_P = -\frac{\Delta}{2} - \frac{\varepsilon^{2}}{\Delta}\]</p><h3 id="Comparison-with-Exact-Solution"><a class="docs-heading-anchor" href="#Comparison-with-Exact-Solution">Comparison with Exact Solution</a><a id="Comparison-with-Exact-Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-with-Exact-Solution" title="Permalink"></a></h3><p>The exact ground state energy is:</p><p class="math-container">\[E_- = -\sqrt{\frac{\Delta^2}{4} + \varepsilon^2} \approx -\frac{\Delta}{2} - \frac{\varepsilon^2}{\Delta} + O(\varepsilon^4)\]</p><p>The SW result matches the perturbation expansion exactly!</p><table><tr><th style="text-align: center"><span>$\varepsilon/\Delta$</span></th><th style="text-align: center">Exact</th><th style="text-align: center">SW (2nd order)</th><th style="text-align: center">Error</th></tr><tr><td style="text-align: center">0.01</td><td style="text-align: center">-0.50005</td><td style="text-align: center">-0.5001</td><td style="text-align: center">0.00%</td></tr><tr><td style="text-align: center">0.05</td><td style="text-align: center">-0.50125</td><td style="text-align: center">-0.5025</td><td style="text-align: center">0.00%</td></tr><tr><td style="text-align: center">0.10</td><td style="text-align: center">-0.50499</td><td style="text-align: center">-0.51</td><td style="text-align: center">0.02%</td></tr><tr><td style="text-align: center">0.20</td><td style="text-align: center">-0.51980</td><td style="text-align: center">-0.54</td><td style="text-align: center">0.28%</td></tr></table><hr/><h2 id="Rabi-Model:-Bloch-Siegert-Shift"><a class="docs-heading-anchor" href="#Rabi-Model:-Bloch-Siegert-Shift">Rabi Model: Bloch-Siegert Shift</a><a id="Rabi-Model:-Bloch-Siegert-Shift-1"></a><a class="docs-heading-anchor-permalink" href="#Rabi-Model:-Bloch-Siegert-Shift" title="Permalink"></a></h2><p>The <strong>full Rabi model</strong> includes counter-rotating terms neglected in the rotating-wave approximation:</p><p class="math-container">\[H = \omega a^\dagger a + \frac{\Delta}{2}\sigma_z + g(\sigma^+ + \sigma^-)(a + a^\dagger)\]</p><pre><code class="language-julia hljs">using UnitaryTransformations
using QuantumAlgebra
using Symbolics

QuantumAlgebra.use_σpm(true)

@variables ω Δ g

H = ω * a&#39;()*a() + Δ/2 * σz() + g * (σp() + σm()) * (a() + a&#39;())
P = Subspace(σz() =&gt; -1)

result = schrieffer_wolff(H, P; order=2)
print_latex(result.H_P; name=&quot;H_P&quot;)</code></pre><p><strong>Output:</strong></p><p class="math-container">\[H_P = -\frac{\Delta}{2} + \omega a^{\dagger} a - \frac{g^{2}}{\Delta - \omega} a^{\dagger} a - \frac{g^{2}}{\Delta + \omega} a^{\dagger} a + \frac{g^{2}}{\Delta + \omega} - \frac{g^{2}}{\Delta + \omega} (a^{\dagger})^2 - \frac{g^{2}}{\Delta + \omega} a^2\]</p><h3 id="Physical-Interpretation-2"><a class="docs-heading-anchor" href="#Physical-Interpretation-2">Physical Interpretation</a><a class="docs-heading-anchor-permalink" href="#Physical-Interpretation-2" title="Permalink"></a></h3><p>Compared to Jaynes-Cummings, the full Rabi model produces:</p><ol><li><strong>JC dispersive shift</strong>: <span>$-g^2/(\Delta - \omega)$</span> from rotating terms</li><li><strong>Bloch-Siegert shift</strong>: <span>$-g^2/(\Delta + \omega)$</span> from counter-rotating terms</li><li><strong>Squeezing terms</strong>: <span>$a^2$</span> and <span>$(a^\dagger)^2$</span> that squeeze the cavity field</li></ol><p>The total dispersive shift combines both contributions:</p><p class="math-container">\[\chi_{\text{total}} = -\frac{g^2}{\Delta - \omega} - \frac{g^2}{\Delta + \omega}\]</p><hr/><h2 id="N-Level-Atom-in-a-Cavity"><a class="docs-heading-anchor" href="#N-Level-Atom-in-a-Cavity">N-Level Atom in a Cavity</a><a id="N-Level-Atom-in-a-Cavity-1"></a><a class="docs-heading-anchor-permalink" href="#N-Level-Atom-in-a-Cavity" title="Permalink"></a></h2><p>For atoms with more than two levels, use <code>nlevel_ops</code>:</p><pre><code class="language-julia hljs">using UnitaryTransformations
using QuantumAlgebra
using Symbolics

# 5-level atom: σ[i,j] = |i⟩⟨j|
σ5 = nlevel_ops(5, :q)

ω = [Symbolics.variable(Symbol(&quot;ω&quot;, i)) for i in 1:5]
@variables ωc g

# Atom + cavity + dipole coupling |1⟩↔|3⟩
H = sum(ω[i] * σ5[i,i] for i in 1:5) + 
    ωc * a&#39;()*a() + 
    g * (σ5[1,3] * a&#39;() + σ5[3,1] * a())

# Zero-photon subspace
P = Subspace(a&#39;()*a() =&gt; 0)

result = schrieffer_wolff(H, P; order=2)
show_result(result)</code></pre><p><strong>Generator:</strong></p><p class="math-container">\[S = \frac{g}{\omega_1 - \omega_3 - \omega_c} |1\rangle\langle 3| \, a^{\dagger} + \frac{g}{\omega_3 - \omega_1 + \omega_c} |3\rangle\langle 1| \, a\]</p><h3 id="Physical-Interpretation-3"><a class="docs-heading-anchor" href="#Physical-Interpretation-3">Physical Interpretation</a><a class="docs-heading-anchor-permalink" href="#Physical-Interpretation-3" title="Permalink"></a></h3><ul><li><strong>Dispersive shift</strong>: <span>$\chi_{13} = g^2/(\omega_1 - \omega_3 + \omega_c)$</span></li><li><strong>AC Stark shifts</strong> on levels 1 and 3</li><li><strong>Other levels</strong> (2, 4, 5) appear only with bare energies</li></ul><hr/><h2 id="Three-Level-Lambda-System"><a class="docs-heading-anchor" href="#Three-Level-Lambda-System">Three-Level Lambda System</a><a id="Three-Level-Lambda-System-1"></a><a class="docs-heading-anchor-permalink" href="#Three-Level-Lambda-System" title="Permalink"></a></h2><p>For systems with SU(N) symmetry, use <code>su_generators</code>:</p><pre><code class="language-julia hljs">using UnitaryTransformations
using QuantumAlgebra
using Symbolics

# Gell-Mann matrices for SU(3)
λ = su_generators(3, :λ)

@variables Δ Ω₁ Ω₂

# Lambda system
H = Δ * λ[8] + Ω₁ * λ[1] + Ω₂ * λ[4]

P = Subspace(λ[8] =&gt; 1/sqrt(3))

result = schrieffer_wolff(H, P; order=2)
show_result(result)</code></pre><p>The package automatically detects SU(3) and uses the matrix-element method.</p><h3 id="When-to-Use-SU(N)-vs-N-Level"><a class="docs-heading-anchor" href="#When-to-Use-SU(N)-vs-N-Level">When to Use SU(N) vs N-Level</a><a id="When-to-Use-SU(N)-vs-N-Level-1"></a><a class="docs-heading-anchor-permalink" href="#When-to-Use-SU(N)-vs-N-Level" title="Permalink"></a></h3><table><tr><th style="text-align: right">Approach</th><th style="text-align: right">Use When</th></tr><tr><td style="text-align: right"><code>nlevel_ops</code></td><td style="text-align: right">Physical atoms, specific transitions</td></tr><tr><td style="text-align: right"><code>su_generators</code></td><td style="text-align: right">Systems with SU(N) symmetry</td></tr></table><hr/><h2 id="Running-the-Examples"><a class="docs-heading-anchor" href="#Running-the-Examples">Running the Examples</a><a id="Running-the-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-Examples" title="Permalink"></a></h2><p>Complete example files are in the <code>examples/</code> directory:</p><pre><code class="language-bash hljs">julia --project examples/jaynes_cummings_dispersive.jl
julia --project examples/two_level_system.jl
julia --project examples/rabi_bloch_siegert.jl
julia --project examples/three_level_atom.jl</code></pre><hr/><h2 id="Tips"><a class="docs-heading-anchor" href="#Tips">Tips</a><a id="Tips-1"></a><a class="docs-heading-anchor-permalink" href="#Tips" title="Permalink"></a></h2><ol><li><strong>Use <code>show_result(result)</code></strong> to see all components in LaTeX</li><li><strong>Use <code>to_latex(expr)</code></strong> to get a LaTeX string for any expression</li><li><strong>Use <code>extract_coefficient(expr, op)</code></strong> to get specific parameters</li><li><strong>Use <code>substitute_values(expr, Dict(...))</code></strong> for numerical evaluation</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../api/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 5 January 2026 13:09">Monday 5 January 2026</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
